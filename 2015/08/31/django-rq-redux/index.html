<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="google-site-verification" content="5_8DTmIiEq4gFvNAfxAD6TsGOgrMAjp8lQFQvfA6zZc" />
  <title>django-rq redux: advanced techniques and tools &mdash; /var/</title>
  <meta name="author" content="Serafeim Papastefanos">






  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">


    <link href="../../../../favicon.png" rel="icon">

  <link href="../../../../theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">

  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="../../../../">/var/</a></h1>
    <h2>Various programming stuff</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>


<ul class="main-navigation">
      <li >
        <a href="../../../../category/css.html">Css</a>
      </li>
      <li class="active">
        <a href="../../../../category/django.html">Django</a>
      </li>
      <li >
        <a href="../../../../category/flask.html">Flask</a>
      </li>
      <li >
        <a href="../../../../category/git.html">Git</a>
      </li>
      <li >
        <a href="../../../../category/javascript.html">Javascript</a>
      </li>
      <li >
        <a href="../../../../category/pelican.html">Pelican</a>
      </li>
      <li >
        <a href="../../../../category/python.html">Python</a>
      </li>
      <li >
        <a href="../../../../category/spring.html">Spring</a>
      </li>
      <li >
        <a href="../../../../category/wagtail.html">Wagtail</a>
      </li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">django-rq redux: advanced techniques and tools</h1>
    <p class="meta">
<time datetime="2015-08-31T14:20:00+03:00" pubdate>Δευ 31 Αύγουστος 2015</time>    </p>
</header>

  <div class="entry-content"><div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id1">Introduction</a><ul>
<li><a class="reference internal" href="#multiple-django-apps-single-redis-db" id="id2">Multiple django-apps, single redis&nbsp;db</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion" id="id3">Conclusion</a></li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id1">Introduction</a></h2>
<p>In the <a class="reference external" href="../../../../2015/01/27/async-tasks-with-django-rq/">previous django-rq article</a>
we presented a quick introduction to asynchronous job queues and created a
small (but complete) project that used rq and django-rq to implement asynchronous
job queues in a django&nbsp;project.</p>
<p>In this article, we will present some more advanced techniques and tools
for improving the capabilities of our asynchronous tasks and
integrate them to the <a class="reference external" href="https://github.com/spapas/django-test-rq">https://github.com/spapas/django-test-rq</a>&nbsp;project.</p>
<div class="section" id="multiple-django-apps-single-redis-db">
<h3><a class="toc-backref" href="#id2">Multiple django-apps, single redis&nbsp;db</a></h3>
<p>One thing to keep in mind is that the only thing that seperates the queues are
their name. If you have many django applications that define a &quot;default&quot; (or &quot;low&quot;, &quot;hight&quot; etc)
and they all use the <em>same</em> redis database to store their queue, the workers
of each application won&#8217;t know which jobs belong to them and they&#8217;ll end up
dequeuing the wrong job types. This will lead to an exception or, if you
are really unlucky to a very nasty&nbsp;bug!</p>
<p>To avoid this, you can either use a different redis database (not database server)
for each of your apps or add a prefix with the name of your app to your queue&nbsp;names:</p>
<p>Each redis database server can host a number of databases that are identified
by a number (that&#8217;s what the /0 you see in <tt class="docutils literal"><span class="pre">redis://127.0.0.1:6379/0</span></tt> means)
and each one of them has a totally different keyspace. So, if you use /0 in an
application and /1 in another application, you&#8217;ll have no problems. This solution
has the disadvantage that you need to be really careful to use different database
numbers for your projects and also the number of possible databases that redis
can use is limited by a configuration file (so if you reach the maximum you&#8217;ll
need to also increase that&nbsp;number)!</p>
<p>Instead of this, you can avoid using the &#8216;default&#8217; queue, and yse queues that
contain your application name in their name, for example, for the sample project
you could create something like &#8216;django-test-rq-default&#8217;, &#8216;django-test-rq-low&#8217;,
&#8216;django-test-rq-high&#8217; etc. You don&#8217;t need to do anything to create these queues,
you just have to put the jobs to these queues using for example the job decorator
(<tt class="docutils literal"><span class="pre">&#64;job('django-test-rq-default')</span></tt>)
and run your workers so that they will retrieve jobs from these queues
(<tt class="docutils literal">python manage.py rqworker <span class="pre">django-test-rq-default</span></tt>).</p>
</div>
</div>
<div class="section" id="conclusion">
<h2><a class="toc-backref" href="#id3">Conclusion</a></h2>
<p>Although using job queues makes it more difficult for the developer and adds at least one
(and probably more) points of failure to a project (the workers, the broker etc) their
usage, even for very simple projects is&nbsp;unavoidable.</p>
<p>Unless a complex, enterprise solution like celery is really required for a project
I recommend using the much simpler and easier to configure <span class="caps">RQ</span> for all your
asynchronous and scheduled task needs. Using <span class="caps">RQ</span> (and the relative projects django-rq
and rq-scheduler) we can easily add production ready queueued and scheduled jobs to
any django&nbsp;project.</p>
<p>In this article we presented a small introduction to <span class="caps">RQ</span> and its friends and saw how
to configure django to use it in a production ready environment using a small
django project (<a class="reference external" href="https://github.com/spapas/django-test-rq">https://github.com/spapas/django-test-rq</a>) which was implemented as a companion
to help readers quickly test the concepts presented&nbsp;here.</p>
</div>
</div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">
        Serafeim Papastefanos
    </span>
  </span>
<time datetime="2015-08-31T14:20:00+03:00" pubdate>Δευ 31 Αύγουστος 2015</time>  <span class="categories">
    <a class='category' href='../../../../category/django.html'>django</a>
  </span>
  <span class="categories">
    <a class="category" href="../../../../tag/django.html">django</a>,    <a class="category" href="../../../../tag/python.html">python</a>,    <a class="category" href="../../../../tag/tasks.html">tasks</a>,    <a class="category" href="../../../../tag/jobs.html">jobs</a>,    <a class="category" href="../../../../tag/rq.html">rq</a>,    <a class="category" href="../../../../tag/django-rq.html">django-rq</a>,    <a class="category" href="../../../../tag/asynchronous.html">asynchronous</a>,    <a class="category" href="../../../../tag/scheduling.html">scheduling</a>,    <a class="category" href="../../../../tag/redis.html">redis</a>  </span>
</p><div class="sharing">
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="../../../../2015/08/31/django-rq-redux/" data-via="" data-counturl="../../../../2015/08/31/django-rq-redux/" >Tweet</a>
</div>    </footer>
  </article>

</div>
<aside class="sidebar">
  <section>
  <br />
  <a href='/feeds/all.atom.xml'>Atom</a> 
  |
  <a href='/feeds/all.rss.xml'>RSS</a> 
  </section>
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="../../../../2015/08/31/django-rq-redux/">django-rq redux: advanced techniques and tools</a>
      </li>
      <li class="post">
          <a href="../../../../2015/07/02/comprehensive-react-flux-tutorial-2/">A comprehensive React and Flux tutorial part 2: Flux</a>
      </li>
      <li class="post">
          <a href="../../../../2015/06/05/comprehensive-react-flux-tutorial/">A comprehensive React and Flux tutorial part 1: React</a>
      </li>
      <li class="post">
          <a href="../../../../2015/05/27/using-browserify-watchify/">Using browserify and watchify to improve your client-side-javascript workflow</a>
      </li>
      <li class="post">
          <a href="../../../../2015/04/29/django-show-404-page/">Show 404 page on django when DEBUG=True</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="../../../../category/css.html">css</a></li>
        <li><a href="../../../../category/django.html">django</a></li>
        <li><a href="../../../../category/flask.html">flask</a></li>
        <li><a href="../../../../category/git.html">git</a></li>
        <li><a href="../../../../category/javascript.html">javascript</a></li>
        <li><a href="../../../../category/pelican.html">pelican</a></li>
        <li><a href="../../../../category/python.html">python</a></li>
        <li><a href="../../../../category/spring.html">spring</a></li>
        <li><a href="../../../../category/wagtail.html">wagtail</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
    <a href="../../../../tag/pelican.html">pelican</a>,    <a href="../../../../tag/tasks.html">tasks</a>,    <a href="../../../../tag/less.html">less</a>,    <a href="../../../../tag/spring.html">spring</a>,    <a href="../../../../tag/rest.html">rest</a>,    <a href="../../../../tag/google.html">google</a>,    <a href="../../../../tag/cbv.html">cbv</a>,    <a href="../../../../tag/scheduling.html">scheduling</a>,    <a href="../../../../tag/auditing.html">auditing</a>,    <a href="../../../../tag/static-html.html">static-html</a>,    <a href="../../../../tag/git.html">git</a>,    <a href="../../../../tag/java.html">java</a>,    <a href="../../../../tag/rq.html">rq</a>,    <a href="../../../../tag/uglify.html">uglify</a>,    <a href="../../../../tag/django-rq.html">django-rq</a>,    <a href="../../../../tag/nodejs.html">node.js</a>,    <a href="../../../../tag/redis.html">redis</a>,    <a href="../../../../tag/heroku.html">heroku</a>,    <a href="../../../../tag/forms.html">forms</a>,    <a href="../../../../tag/github-pages.html">github-pages</a>,    <a href="../../../../tag/404.html">404</a>,    <a href="../../../../tag/ldap.html">ldap</a>,    <a href="../../../../tag/gmail.html">gmail</a>,    <a href="../../../../tag/spring-security.html">spring-security</a>,    <a href="../../../../tag/css.html">css</a>,    <a href="../../../../tag/node.html">node</a>,    <a href="../../../../tag/jobs.html">jobs</a>,    <a href="../../../../tag/watchify.html">watchify</a>,    <a href="../../../../tag/python.html">python</a>,    <a href="../../../../tag/mongodb.html">mongodb</a>,    <a href="../../../../tag/javascript.html">javascript</a>,    <a href="../../../../tag/authentication.html">authentication</a>,    <a href="../../../../tag/react.html">react</a>,    <a href="../../../../tag/class-based-views.html">class-based-views</a>,    <a href="../../../../tag/npm.html">npm</a>,    <a href="../../../../tag/rst.html">rst</a>,    <a href="../../../../tag/generic.html">generic</a>,    <a href="../../../../tag/browserify.html">browserify</a>,    <a href="../../../../tag/branching.html">branching</a>,    <a href="../../../../tag/design.html">design</a>,    <a href="../../../../tag/github.html">github</a>,    <a href="../../../../tag/pusher.html">pusher</a>,    <a href="../../../../tag/windows.html">windows</a>,    <a href="../../../../tag/wagtail.html">wagtail</a>,    <a href="../../../../tag/django.html">django</a>,    <a href="../../../../tag/flux.html">flux</a>,    <a href="../../../../tag/githubio.html">github.io</a>,    <a href="../../../../tag/error.html">error</a>,    <a href="../../../../tag/debug.html">debug</a>,    <a href="../../../../tag/asynchronous.html">asynchronous</a>,    <a href="../../../../tag/security.html">security</a>,    <a href="../../../../tag/flask.html">flask</a>,    <a href="../../../../tag/boostrap-material-design.html">boostrap-material-design</a>  </section>



</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
    Copyright &copy;  2013&ndash;2015  Serafeim Papastefanos &mdash;
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
  <script src="../../../../theme/js/modernizr-2.0.js"></script>
  <script src="../../../../theme/js/ender.js"></script>
  <script src="../../../../theme/js/octopress.js" type="text/javascript"></script>
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-44750952-1', 'auto');

    ga('send', 'pageview');
    </script>
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>
</body>
</html>